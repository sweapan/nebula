<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.0"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Nebula: $title</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Nebula
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_profiling.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="contents">
<div class="textblock"><h1><a class="anchor" id="NebulaProfiling"></a>
The Profiling Subsystem</h1>
<p>The <a class="el" href="namespace_profiling.html">Profiling</a> system provides very much needed functions which allows for measuring the time some code is taking, or to provide a thread-safe counting mechanism, such as counting the amount of bytes allocated, triangles drawn, or what have you. The <a class="el" href="namespace_profiling.html">Profiling</a> API is very simple to use.</p>
<h2><a class="anchor" id="NebulaProfilingThreads"></a>
Profiling Thread Contexts</h2>
<p>If starting a new thread, on which you would like to, or have to support profiling, run <a class="el" href="namespace_profiling.html#aa3a2d859fbe9ec549597bdd1ba435941" title="register a new thread for the profiling">Profiling::ProfilingRegisterThread()</a> when within the context of that thread. Don't worry about the JobPort, it takes care of this for us.</p>
<h2><a class="anchor" id="NebulaProfilingScopes"></a>
Scopes</h2>
<p>Time-keeping is implemented through scopes. We can think of the start of the scope as starting a timer, and the end as closing it. To open a scope, we initialize a <a class="el" href="struct_profiling_1_1_profiling_scope.html">Profiling::ProfilingScope</a> which we provide with a name, category, file, line in that file, and a flag if this scope is unique, or there will be many smaller scopes following, which we want to accumulate the value for, rather than create unique ones. Then we push the scope to the <a class="el" href="namespace_profiling.html">Profiling</a> <a class="el" href="namespace_system.html">System</a> by using <a class="el" href="namespace_profiling.html#aa4ab426d9fcd5a10a97714aaa78a063d" title="push scope to scope stack">Profiling::ProfilingPushScope()</a>. When we are at the end of the area of code we want to profile, we run <a class="el" href="namespace_profiling.html#a4d91ef62a48f28917a4137594ee12cf2" title="pop scope from scope stack">Profiling::ProfilingPopScope()</a>.</p>
<p>Thankfully for us, there are macros implemented in <a class="el" href="profiling_8h.html">profiling/profiling.h</a> which provides a shorthand for this. <code>N_SCOPE</code> will automatically push a scope to the stack and pop it when the curly brackets go out of scope. To use <code>N_SCOPE</code> with a dynamic, i.e. string variable name, use <code>N_SCOPE_DYN</code>. To use accumulative scopes, use <code>N_SCOPE_ACCUM</code> and <code>N_SCOPE_DYN_ACCUM</code>. If you don't want the restrictions of using an actual C scope to handle your timing, there is also <code>N_MARKER_BEGIN/N_MARKER_DYN_BEGIN</code>, which has to be followed by an <code>N_MARKER_END</code>.</p>
<h2><a class="anchor" id="NebulaProfilingCounters"></a>
Counters</h2>
<p>We can also use counters which are useful mechanism for keeping track of certain things we do, such that we may know if we're following certain budget constraints. To declare a counter, use the <code>N_DECLARE_COUNTER</code> macro. This will only actually instantiate a static const char*, which we can use the unique pointer for to lookup or change the value in a hash table. To modify this value later, use either <a class="el" href="namespace_profiling.html#a4aae1001e25d260c708a347e26d854af" title="increment profiling counter">Profiling::ProfilingIncreaseCounter</a> and <a class="el" href="namespace_profiling.html#a7ed4a468cc81f8e986ebd8e51c24e485" title="decrement profiling counter">Profiling::ProfilingDecreaseCounter</a> or, for consistency, the macros <code>N_COUNTER_INCR</code> and <code>N_COUNTER_DECR</code>.</p>
<h2><a class="anchor" id="NebulaProfilingReadback"></a>
Reading Profiling Results</h2>
<p>Now, we would like to somehow extract all the counters, and all the timings for our frame. We can extract counter values with <a class="el" href="namespace_profiling.html#a37fdbc46ecd7650aa2b8610b72c7309e" title="return table of counters">Profiling::ProfilingGetCounters()</a>, and profiling scopes with <a class="el" href="namespace_profiling.html#a7dbe55b77186178770f4c3658c51d436" title="get all top level scopes based on thread, only run when you know the thread is finished">Profiling::ProfilingGetScopes()</a> for a single thread, or all per-thread contexts, which then contains the scopes, using <a class="el" href="namespace_profiling.html#a6746b2cd8f941288f2b0b2b4ee0258ed" title="get all profiling contexts">Profiling::ProfilingGetContexts()</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="navelem"><a class="el" href="foundation.html">Foundation Libraries</a></li>
				<li class="footer">
					Generated on Sun Jan 17 2021 20:24:57 for Nebula. Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>
