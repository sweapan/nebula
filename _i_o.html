<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.0"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Nebula: $title</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Nebula
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_i_o.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="contents">
<div class="textblock"><h1><a class="anchor" id="NebulaIOSystem"></a>
The IO Subsystem</h1>
<p>The Nebula <a class="el" href="namespace_i_o.html" title="Instances of wrapped stream classes.">IO</a> subsystem is a huge step forward from the Nebula1 and Nebula2 <a class="el" href="namespace_i_o.html" title="Instances of wrapped stream classes.">IO</a> systems. The main design goals of the new <a class="el" href="namespace_i_o.html" title="Instances of wrapped stream classes.">IO</a> subsystem are:</p>
<ul>
<li>use more standard mechanisms, like URIs to identify resource locations, and MIME types to identify data formats</li>
<li>a flexible stream model, it shouldn't matter whether data comes from a file, from a memory buffer, an HTTP connection or somewhere else</li>
<li>reading and writing data from and to a stream in different data formats should be more orthogonal, for instance it shouldn't matter if XML-formatted data is read from memory, from a file, from a network connection or from anywhere else</li>
<li>extensibility, new stream and reader/writer classes can be registered with the <a class="el" href="namespace_i_o.html" title="Instances of wrapped stream classes.">IO</a> subsystem at runtime</li>
<li>portability without performance compromises, the entire <a class="el" href="namespace_i_o.html" title="Instances of wrapped stream classes.">IO</a> subsystem must be able to use platform-specific <a class="el" href="namespace_i_o.html" title="Instances of wrapped stream classes.">IO</a> functions under the hood instead of relying to CLib functions like fopen() for portability, which may come with an additional performance or memory overhead compared to the platform specific <a class="el" href="namespace_i_o.html" title="Instances of wrapped stream classes.">IO</a> functions</li>
</ul>
<p>The main concepts of the Nebula <a class="el" href="namespace_i_o.html" title="Instances of wrapped stream classes.">IO</a> subsystem are:</p>
<ul>
<li>A central <b><a class="el" href="class_i_o_1_1_console.html" title="Nebula&#39;s console, this is the central place for command- line-style communication with the user.">IO::Console</a></b> object for <b>all</b> text input and output with attachable console handlers. It is guaranteed that all Nebula text output goes through the console as the one centralized in/out channel. Specialized console handlers can be used to handle text output in a special way (for instance writing the output to stdout, an ingame console, a log file or a network connection).</li>
<li><b>Assigns</b> as path aliases. The general functionality is the same as in Nebula1 and Nebula2, or the original AmigaOS assigns which inspired Nebula's assign mechanism. A new feature of Nebula assigns is that they can be aliases for complete URI's. For instance, the assign "textures:" could be defined as "http://www.radonlabs.de/textures", so that the shortcut resource path "textures:mytexture.dds" would be resolve to the absolute location "http://www.radonlabs.de/textures/mytexture.dds"</li>
<li><b>Streams</b> as basic in/out data channel. Streams are the replacement for Nebula2's nFile objects. Streams offer the same basic API with Open()/Close()/Read()/Write(), but may hide completely different transport or storage channels behind their common interface. Examples of stream classes are <a class="el" href="class_i_o_1_1_file_stream.html" title="A stream to which offers read/write access to filesystem files.">IO::FileStream</a>, <a class="el" href="class_i_o_1_1_memory_stream.html" title="Implements a stream class which writes to and reads from system RAM.">IO::MemoryStream</a>, or <a class="el" href="class_http_1_1_http_stream.html" title="Wraps client HTTP requests to a HTTP server into an IO::Stream.">Http::HttpStream</a></li>
<li><b>Stream readers and writers</b> are attached to streams and generally implement easy-to-use interfaces to read and write different data formats. For instance one could attach an <a class="el" href="class_i_o_1_1_xml_reader.html" title="Reads XML formatted data with random access from a stream using TinyXML as backend.">IO::XmlReader</a> to a <a class="el" href="class_i_o_1_1_file_stream.html" title="A stream to which offers read/write access to filesystem files.">IO::FileStream</a> to read XML-formatted data from a filesystem file, or attach it to an IO::HttpStream to read XML-formatted data from a HTTP connection.</li>
</ul>
<p>A good example to show the power of the Nebula in/out system is the following code fragment:</p>
<div class="fragment"><div class="line">IO::FileServer::Instance()-&gt;CopyFile(<span class="stringliteral">&quot;https://en.wikipedia.org/wiki/Radon_Labs#/media/File:Radonlabslogo.svg&quot;</span>, <span class="stringliteral">&quot;temp:logo.svg&quot;</span>);</div>
</div><!-- fragment --><p>This single line of code copies a file from a HTTP server into the current user's temp directory. With only a few lines more you could create a stream object pointing to a HTML file on a HTTP server, attach an XML reader to the stream, and parse the content of the HTML file without any intermediate storage file.</p>
<h2><a class="anchor" id="NebulaAssigns"></a>
Standard Assigns</h2>
<p>Nebula initializes the following standard assigns:</p>
<ul>
<li><b>home:</b> Points to the application directory, in a US Windows installation, this is usually somewhere under "C:/Programs". Nebula applications should treat the home: location as a read only directory so that the user doesn't need administrator rights to run the application.</li>
<li><b>user:</b> This points to the currently logged in user directory for this Nebula application. In a US Windows installation, this is somewhere under "C:/Users/[username]/Documents". Nebula will automatically create a local directory in the user directory to prevent different applications to overwrite their data. It is generally safe to write data to the user directory. This is the place where configuration and save game data should be written, or any other data which should persist between application invokations.</li>
<li><b>temp:</b> This assign points to the current user's temp directory. This directory is generally writable. It should not be assumed that data in temp: survives until the next application start.</li>
<li><b>bin:</b> This points to the directory of the application's executable file. This may or may not be identical with the home: directory. The bin: assign should be treated as read-only.</li>
</ul>
<p>Custom assigns may be defined at runtime by the application. Often this is used to define abstract path to resources like textures, sound data, and so on. That way the locations of those resources can be easily changes by setting a single assign instead of fixing all the resource paths. A nice side effect of assigns is that a path with assigns is often much shorter then an "absolute" path resulting in a smaller memory footprint.</p>
<h2><a class="anchor" id="NebulaURI"></a>
URIs</h2>
<p>Resource locations are generally defined through standard URIs in Nebula. URIs may consist of the following parts, some of them optional:</p>
<ul>
<li>a scheme, for instance "http:", "file:", etc... Nebula doesn't define any hardcoded schemes, instead, schemes are bound to stream classes by registering them with the IO::StreamServer singleton</li>
<li>an optional user info field, often this is a login name and a password to authenticate with a remote FTP or HTTP host</li>
<li>a hostname, like "www.radonlabs.de"</li>
<li>an optional portname following the hostname</li>
<li>a local path, pointing to a resource on the host</li>
<li>an optional fragment, which often points to a location inside the resource</li>
<li>an optional query part, which often contains arguments for a PHP script or some similar dynamic response mechamism</li>
</ul>
<p>The class <a class="el" href="class_i_o_1_1_u_r_i.html" title="An URI object can split a Uniform Resource Identifier string into its components or build a string fr...">IO::URI</a> is used to pass URIs around and to crack URI strings into its various components. It should be noted however, that an URI object has a bigger memory footprint compared to storing the URI in a simple string. So sometimes it may be better keep URIs around in strings and only use the <a class="el" href="class_i_o_1_1_u_r_i.html" title="An URI object can split a Uniform Resource Identifier string into its components or build a string fr...">IO::URI</a> class to split the URI string into its parts.</p>
<p>Here are some examples for URI's:</p>
<pre class="fragment">file:///c:/temp/bla.txt
file://samba/temp/bla.txt
http://www.radonlabs.de/index.html
http://user:password@www.myserver.com:8080/index.html#main
</pre><p>By using Nebula assigns you can simplify those complex pathnames a lot. To reference a file in the application directory you can write for instance <b>home:bla.txt</b> which would resolve to something like <b><a href="file:///c:/programme/">file:///c:/programme/</a>[myapp]/bla.txt</b>.</p>
<h2><a class="anchor" id="NebulaStreamsReadersWriters"></a>
Streams, Readers and Writers</h2>
<p>Streams provide a common interface for storing or transporting raw data. They replace the nFile class of Nebula2 with a much more general approach for storing, retrieving and transporting data. A stream object provides the traditional Open()/Close()/Read()/Write()/Seek() interface. Some stream classes provide memory mapping, so that data can be read or written by direct memory access. Stream objects use an <a class="el" href="class_i_o_1_1_u_r_i.html" title="An URI object can split a Uniform Resource Identifier string into its components or build a string fr...">IO::URI</a> object to define their resource location. Usually, one URI scheme maps to a specific stream class. For instance the URI scheme "http:" usually maps to the Net::HttpStream class, while the scheme "file:" maps to the <a class="el" href="class_i_o_1_1_file_stream.html" title="A stream to which offers read/write access to filesystem files.">IO::FileStream</a> class. This mapping is implemented by the StreamServer which constructs a matching stream object given an URI. A Nebula application is responsible to provide the mapping of URI scheme to stream classes using the StreamServer::Register() method. This is also the way how new stream classes and schemes are registered with Nebula.</p>
<p>Important stream classes in Nebula are for instance:</p>
<ul>
<li><a class="el" href="class_i_o_1_1_file_stream.html" title="A stream to which offers read/write access to filesystem files.">IO::FileStream</a>: provides access to the host's filesystem</li>
<li><a class="el" href="class_i_o_1_1_memory_stream.html" title="Implements a stream class which writes to and reads from system RAM.">IO::MemoryStream</a>: a dynamic memory buffer with a stream interface</li>
<li>IO::HttpStream: provides a stream interface to files on a HTTP server</li>
</ul>
<p>To read and write formatted stream data in a more flexible way then Nebula2, stream reader and stream writer classes have been introduced in Nebula. Stream reader and writer classes provide a comfortable interface which is specialized on a specific data format. Here are some examples of stream readers and writers provided by Nebula:</p>
<ul>
<li><a class="el" href="class_i_o_1_1_binary_reader.html" title="A friendly interface to read binary data from a stream.">IO::BinaryReader</a>/IO::BinaryWriter: read and write binary data</li>
<li><a class="el" href="class_i_o_1_1_text_reader.html" title="A friendly interface for reading text data from a stream.">IO::TextReader</a>/IO::TextWriter: read and write text and character data</li>
<li><a class="el" href="class_i_o_1_1_xml_reader.html" title="Reads XML formatted data with random access from a stream using TinyXML as backend.">IO::XmlReader</a>/IO::XmlWriter: read and write XML formatted data</li>
<li><a class="el" href="class_messaging_1_1_message_reader.html" title="Implements a binary stream protocol for decoding messages from a stream.">Messaging::MessageReader</a>/Messaging::MessageWriter: Message serialization</li>
</ul>
<p>Here's a simple example how to access a file on a HTTP server with a XmlReader:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespace_i_o.html">IO</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="class_ptr.html">Ptr&lt;Stream&gt;</a> stream = StreamServer::Instance()-&gt;CreateStream(<span class="stringliteral">&quot;http://www.radonlabs.de/index.html&quot;</span>);</div>
<div class="line"><a class="code" href="class_ptr.html">Ptr&lt;XmlReader&gt;</a> xmlReader = <a class="code" href="namespace_game_1_1_time_manager.html#a18c6aa9e2f022cec2293bc8ba843ac6f">XmlReader::Create</a>();</div>
<div class="line">xmlReader-&gt;SetStream(stream);</div>
<div class="line"><span class="keywordflow">if</span> (xmlReader-&gt;Open())</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// parse content here using the XmlReader interface</span></div>
<div class="line">}</div>
<div class="ttc" id="aclass_ptr_html"><div class="ttname"><a href="class_ptr.html">Ptr</a></div><div class="ttdoc">Nebula's smart pointer class which manages the life time of RefCounted objects.</div><div class="ttdef"><b>Definition:</b> ptr.h:38</div></div>
<div class="ttc" id="anamespace_game_1_1_time_manager_html_a18c6aa9e2f022cec2293bc8ba843ac6f"><div class="ttname"><a href="namespace_game_1_1_time_manager.html#a18c6aa9e2f022cec2293bc8ba843ac6f">Game::TimeManager::Create</a></div><div class="ttdeci">Game::ManagerAPI Create()</div><div class="ttdoc">create the singleton</div><div class="ttdef"><b>Definition:</b> timemanager.cc:62</div></div>
<div class="ttc" id="anamespace_i_o_html"><div class="ttname"><a href="namespace_i_o.html">IO</a></div><div class="ttdoc">Instances of wrapped stream classes.</div><div class="ttdef"><b>Definition:</b> archive.cc:10</div></div>
</div><!-- fragment --><h2><a class="anchor" id="NebulaFileServer"></a>
File Server</h2>
<p>The Nebula IO::FileServer class provides a singleton which offers access to the hosts filesystem for global operations like defining assigns, copying, deleting and checking for existance of files and directories, listing directory contents, and so on.</p>
<p>Here's some sample code fragments for some of the more useful FileServer methods:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespace_i_o.html">IO</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespace_util.html">Util</a>;</div>
<div class="line"> </div>
<div class="line">FileServer* fs = FileServer::Instance();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// check if a file or directory exists</span></div>
<div class="line"><span class="keywordtype">bool</span> fileExists = fs-&gt;FileExists(<span class="stringliteral">&quot;home:bla.txt&quot;</span>);</div>
<div class="line"><span class="keywordtype">bool</span> dirExists = fs-&gt;DirectoryExists(<span class="stringliteral">&quot;temp:bla/blub&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// resolve a path with assigns into an absolute filesystem</span></div>
<div class="line"><span class="comment">// path, this is sometimes necessary to interface with </span></div>
<div class="line"><span class="comment">// 3rd party libraries which don&#39;t understand Nebula paths directly</span></div>
<div class="line">String absPath = fs-&gt;ResolveAssings(<span class="stringliteral">&quot;user:myapp/savegames&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create a directory, note that all missing subdirectories will</span></div>
<div class="line"><span class="comment">// be created as well</span></div>
<div class="line">fs-&gt;CreateDirectory(<span class="stringliteral">&quot;user:myapp/savegames&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// copy and delete files</span></div>
<div class="line">fs-&gt;CopyFile(<span class="stringliteral">&quot;home:movie.mpg&quot;</span>, <span class="stringliteral">&quot;temp:movie.mpg&quot;</span>);</div>
<div class="line">fs-&gt;DeleteFile(<span class="stringliteral">&quot;temp:movie.mpg&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// list files in a directory matching a pattern</span></div>
<div class="line">Array&lt;String&gt; files = fs-&gt;ListFiles(<span class="stringliteral">&quot;temp:&quot;</span>, <span class="stringliteral">&quot;*.txt&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// list all subdirectories in temp:</span></div>
<div class="line">Array&lt;String&gt; dirs = fs-&gt;ListDirectories(<span class="stringliteral">&quot;temp:&quot;</span>, <span class="stringliteral">&quot;*&quot;</span>);</div>
<div class="ttc" id="anamespace_util_html"><div class="ttname"><a href="namespace_util.html">Util</a></div><div class="ttdoc">The ArrayAllocator provides a variadic list of types which is to be contained in the allocator and fe...</div><div class="ttdef"><b>Definition:</b> array.h:37</div></div>
</div><!-- fragment --><h2><a class="anchor" id="NebulaConsole"></a>
The Nebula Console</h2>
<p>[TODO] </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="navelem"><a class="el" href="foundation.html">Foundation Libraries</a></li>
				<li class="footer">
					Generated on Sun Jan 17 2021 09:18:43 for Nebula. Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>
