<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.0"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Nebula: $title</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Nebula
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_ids.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="contents">
<div class="textblock"><h1><a class="anchor" id="NebulaIDSystem"></a>
The Ids Library</h1>
<p>The <a class="el" href="namespace_ids.html" title="An ID allocator associates an id with a slice in an N number of arrays.">Ids</a> library define a set of utility functions and classes used to manage object handles, which are known as <a class="el" href="namespace_ids.html" title="An ID allocator associates an id with a slice in an N number of arrays.">Ids</a>. In <a class="el" href="ids_2id_8h.html">ids/id.h</a> you will find a bunch of utility functions to define an ID with a certain set of bits, be it a 16 + 16 bit id, a 24 + 8 bit id, or what have you. <a class="el" href="idallocator_8h.html">ids/idallocator.h</a> implements what we call an 'id-based allocator', which is implemented like a memory pool of objects, however the objects are not stored as structs, but rather as deconstructed arrays of each member.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>Foo</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> a, b, c;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">IdAllocator&lt;</div>
<div class="line">    int,           <span class="comment">// this is a</span></div>
<div class="line">    int,           <span class="comment">// this is b</span></div>
<div class="line">    <span class="keywordtype">int</span>            <span class="comment">// this is c</span></div>
<div class="line">    &gt;           </div>
<div class="line">    FooAllocator;</div>
</div><!-- fragment --><p>Internally, FooAllocator has just been defined as being a tuple of three Util::Array&lt;int&gt;, one for each type. Each will be numbered, but for the sake of it, let's say that 'member' a is stored in Util::Array&lt;int&gt; A, and b is stored in Util::Array&lt;int&gt; B, etc... The type can of course be different for each member. Whenever <a class="el" href="namespace_memory.html#aaf5b823d7efe2bcc3d5fa52701fbb993" title="Allocate a block of memory from one of the global heaps.">FooAllocator.Alloc()</a> is called, the allocator either allocates more memory for A, B and C, or, if there are free slots, returns that free slot. A slot is freed if FooAllocator first does <a class="el" href="namespace_memory.html#aaf5b823d7efe2bcc3d5fa52701fbb993" title="Allocate a block of memory from one of the global heaps.">Alloc()</a> which returns an Id, then at some later point, that same Id is passed to Dealloc(), which doesn't destroy the memory, but simply marks that slot as free. This allows us to quickly deallocate and reallocate objects without actually having to allocate any memory, and it can keep each individual member separate, which results in a low-fragmentation container which is extremely benificial for the cache. For a better understanding of this, go to <a class="el" href="arrayallocator_8h.html">util/arrayallocator.h</a>. You can think of it this way:</p>
<div class="fragment"><div class="line">FooAllocator<span class="stringliteral">&#39;s initial state:</span></div>
<div class="line"><span class="stringliteral">0 - Used</span></div>
<div class="line"><span class="stringliteral">1 - Used</span></div>
<div class="line"><span class="stringliteral">2 - Used</span></div>
<div class="line"><span class="stringliteral">3 - Used</span></div>
<div class="line"><span class="stringliteral">4 - Used</span></div>
<div class="line"><span class="stringliteral">5 - Used</span></div>
<div class="line"><span class="stringliteral">6 - Used</span></div>
<div class="line"><span class="stringliteral">7 - Used</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">FooAllocator::Dealloc(3) is run:</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">0 - Used</span></div>
<div class="line"><span class="stringliteral">1 - Used</span></div>
<div class="line"><span class="stringliteral">2 - Used</span></div>
<div class="line"><span class="stringliteral">3 - Used -&gt; Free</span></div>
<div class="line"><span class="stringliteral">4 - Used</span></div>
<div class="line"><span class="stringliteral">5 - Used</span></div>
<div class="line"><span class="stringliteral">6 - Used</span></div>
<div class="line"><span class="stringliteral">7 - Used</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">FooAllocator::Alloc() is run:</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">0 - Used</span></div>
<div class="line"><span class="stringliteral">1 - Used</span></div>
<div class="line"><span class="stringliteral">2 - Used</span></div>
<div class="line"><span class="stringliteral">3 - Free -&gt; Used, 3 is returned</span></div>
<div class="line"><span class="stringliteral">4 - Used</span></div>
<div class="line"><span class="stringliteral">5 - Used</span></div>
<div class="line"><span class="stringliteral">6 - Used</span></div>
<div class="line"><span class="stringliteral">7 - Used</span></div>
</div><!-- fragment --><p>You can access the allocators "free-ids" list to perform defragmentation of the allocator manually if necessary. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
		<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
			<ul>
				<li class="navelem"><a class="el" href="foundation.html">Foundation Libraries</a></li>
				<li class="footer">
					Generated on Sun Jan 17 2021 12:08:02 for Nebula. Dark theme by <a href="http://majerle.eu" target="_new">Tilen Majerle</a>. All rights reserved.
				</li>
			</ul>
		</div>
		<script src="custom.js"></script>
	</body>
</html>
